<div class="register-container">
  <div class="register-box">
    <div class="logo-section">
      <h1 class="logo">MediConnect</h1>
      <p class="subtitle">Crea tu cuenta</p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">

      <!-- FILA DE NOMBRE Y APELLIDO -->
      <div class="form-row">
        <div class="form-group">
          <label for="nombre">Nombre</label>
          <input
            id="nombre"
            type="text"
            formControlName="nombre"
            placeholder="Juan"
            class="input-field"
            [class.error]="nombre?.invalid && nombre?.touched">
          <span class="error-text" *ngIf="nombre?.hasError('required') && nombre?.touched">
            El nombre es requerido
          </span>
          <span class="error-text" *ngIf="nombre?.hasError('minlength') && nombre?.touched">
            Mínimo 2 caracteres
          </span>
        </div>

        <div class="form-group">
          <label for="apellido">Apellido</label>
          <input
            id="apellido"
            type="text"
            formControlName="apellido"
            placeholder="Pérez"
            class="input-field"
            [class.error]="apellido?.invalid && apellido?.touched">
          <span class="error-text" *ngIf="apellido?.hasError('required') && apellido?.touched">
            El apellido es requerido
          </span>
          <span class="error-text" *ngIf="apellido?.hasError('minlength') && apellido?.touched">
            Mínimo 2 caracteres
          </span>
        </div>
      </div>

      <!-- CORREO -->
      <div class="form-group">
        <label for="correo">Correo Electrónico</label>
        <input
          id="correo"
          type="email"
          formControlName="correo"
          placeholder="tu@email.com"
          class="input-field"
          [class.error]="correo?.invalid && correo?.touched">
        <span class="error-text" *ngIf="correo?.hasError('required') && correo?.touched">
          El correo es requerido
        </span>
        <span class="error-text" *ngIf="correo?.hasError('invalidEmail') && correo?.touched">
          Ingresa un correo válido (ejemplo: usuario&#64;dominio.com)
        </span>
        <span class="error-text" *ngIf="correo?.hasError('dangerousChars') && correo?.touched">
          El correo contiene caracteres no permitidos
        </span>
      </div>

      <!-- TIPO DE CUENTA -->
      <div class="form-group">
        <label for="rol">Tipo de Cuenta</label>
        <select id="rol" formControlName="rol" class="input-field">
          <option value="paciente">Paciente</option>
          <option value="doctor">Doctor</option>
        </select>
      </div>

      <!-- CÉDULA PROFESIONAL (solo para doctores) -->
      <div class="form-group" *ngIf="isDoctor">
        <label for="cedulaProfesional">Cédula Profesional</label>
        <input
          id="cedulaProfesional"
          type="text"
          formControlName="cedulaProfesional"
          placeholder="12345678"
          class="input-field"
          [class.error]="cedulaProfesional?.invalid && cedulaProfesional?.touched">
        <span class="error-text" *ngIf="cedulaProfesional?.hasError('required') && cedulaProfesional?.touched">
          La cédula profesional es requerida para doctores
        </span>
        <span class="error-text" *ngIf="cedulaProfesional?.hasError('invalidCedula') && cedulaProfesional?.touched">
          Ingresa una cédula válida (8-12 dígitos)
        </span>
        <small class="help-text">Ingresa solo números, sin espacios ni guiones</small>
      </div>

      <!-- CONTRASEÑA -->
      <div class="form-group">
        <label for="password">Contraseña</label>
        <input
          id="password"
          type="password"
          formControlName="password"
          placeholder="••••••••"
          class="input-field"
          [class.error]="password?.invalid && password?.touched">
        <span class="error-text" *ngIf="password?.hasError('required') && password?.touched">
          La contraseña es requerida
        </span>
        <span class="error-text" *ngIf="password?.hasError('minlength') && password?.touched">
          Mínimo 8 caracteres (actualmente: {{ password?.value?.length || 0 }})
        </span>
        <span class="error-text" *ngIf="password?.hasError('weakPassword') && password?.touched">
          La contraseña debe contener: mayúsculas, minúsculas, números y símbolos
        </span>
        <small class="help-text" *ngIf="!password?.touched">
          Debe contener: mayúsculas, minúsculas, números y símbolos especiales
        </small>
      </div>

      <!-- CONFIRMAR CONTRASEÑA -->
      <div class="form-group">
        <label for="confirmPassword">Confirmar Contraseña</label>
        <input
          id="confirmPassword"
          type="password"
          formControlName="confirmPassword"
          placeholder="••••••••"
          class="input-field"
          [class.error]="(confirmPassword?.invalid || registerForm.errors?.['passwordMismatch']) && confirmPassword?.touched">
        <span class="error-text" *ngIf="confirmPassword?.hasError('required') && confirmPassword?.touched">
          Confirma tu contraseña
        </span>
        <span class="error-text" *ngIf="registerForm.errors?.['passwordMismatch'] && confirmPassword?.touched && !confirmPassword?.hasError('required')">
          Las contraseñas no coinciden
        </span>
      </div>

      <!-- MENSAJE DE ERROR GENERAL -->
      <div class="alert alert-error" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <!-- BOTÓN -->
      <button type="submit" class="submit-btn" [disabled]="loading">
        <span *ngIf="!loading">Crear Cuenta</span>
        <span *ngIf="loading">Creando cuenta...</span>
      </button>
    </form>

    <div class="register-footer">
      <p>¿Ya tienes cuenta? <a routerLink="/login">Inicia sesión aquí</a></p>
    </div>
  </div>
</div>
