<div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarAlClickFuera($event)">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="modal-header">
      <div class="header-title">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
        <h2>Editar Perfil Profesional</h2>
      </div>
      <button class="close-btn" (click)="cerrarModal()">‚úï</button>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <!-- Mensajes -->
      <div class="mensaje-exito" *ngIf="mensajeExito">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        {{ mensajeExito }}
      </div>

      <div class="mensaje-error" *ngIf="mensajeError">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="15" y1="9" x2="9" y2="15"></line>
          <line x1="9" y1="9" x2="15" y2="15"></line>
        </svg>
        {{ mensajeError }}
      </div>

      <form [formGroup]="formulario" (ngSubmit)="guardarPerfil()">
        <!-- Informaci√≥n Profesional -->
        <div class="form-section">
          <h3>üìã Informaci√≥n Profesional</h3>

          <div class="form-group">
            <label for="especialidad">Especialidad *</label>
            <input
              id="especialidad"
              type="text"
              formControlName="especialidad"
              placeholder="ej: Medicina General, Cardiolog√≠a"
              class="form-input"
              [ngClass]="{ 'input-error': esCampoInvalido('especialidad') }"
            />
            <span class="error-message" *ngIf="esCampoInvalido('especialidad')">
              {{ obtenerErrorCampo('especialidad') }}
            </span>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="anos_experiencia">A√±os de Experiencia *</label>
              <input
                id="anos_experiencia"
                type="number"
                formControlName="anos_experiencia"
                placeholder="15"
                class="form-input"
                [ngClass]="{ 'input-error': esCampoInvalido('anos_experiencia') }"
              />
              <span class="error-message" *ngIf="esCampoInvalido('anos_experiencia')">
                {{ obtenerErrorCampo('anos_experiencia') }}
              </span>
            </div>

            <div class="form-group">
              <label for="cedula_profesional">C√©dula Profesional *</label>
              <input
                id="cedula_profesional"
                type="text"
                formControlName="cedula_profesional"
                placeholder="MEX123456"
                class="form-input"
                [ngClass]="{ 'input-error': esCampoInvalido('cedula_profesional') }"
              />
              <span class="error-message" *ngIf="esCampoInvalido('cedula_profesional')">
                {{ obtenerErrorCampo('cedula_profesional') }}
              </span>
            </div>
          </div>

          <div class="form-group">
            <label for="universidad">Universidad *</label>
            <input
              id="universidad"
              type="text"
              formControlName="universidad"
              placeholder="Universidad Nacional Aut√≥noma de M√©xico"
              class="form-input"
              [ngClass]="{ 'input-error': esCampoInvalido('universidad') }"
            />
            <span class="error-message" *ngIf="esCampoInvalido('universidad')">
              {{ obtenerErrorCampo('universidad') }}
            </span>
          </div>

          <div class="form-group">
            <label for="telefono">Tel√©fono *</label>
            <input
              id="telefono"
              type="tel"
              formControlName="telefono"
              placeholder="+55 1234 5678"
              class="form-input"
              [ngClass]="{ 'input-error': esCampoInvalido('telefono') }"
            />
            <span class="error-message" *ngIf="esCampoInvalido('telefono')">
              {{ obtenerErrorCampo('telefono') }}
            </span>
          </div>

          <div class="form-group">
            <label for="descripcion">Descripci√≥n Profesional</label>
            <textarea
              id="descripcion"
              formControlName="descripcion"
              placeholder="M√©dico general con amplia experiencia en atenci√≥n primaria..."
              class="form-input"
              rows="4"
              [ngClass]="{ 'input-error': esCampoInvalido('descripcion') }"
            ></textarea>
            <span class="error-message" *ngIf="esCampoInvalido('descripcion')">
              {{ obtenerErrorCampo('descripcion') }}
            </span>
          </div>

          <div class="form-group">
            <label for="tarifa_consulta">üí∞ Tarifa de Consulta (en tu moneda local) *</label>
            <input
              id="tarifa_consulta"
              type="number"
              step="0.01"
              formControlName="tarifa_consulta"
              placeholder="200.00"
              class="form-input"
              [ngClass]="{ 'input-error': esCampoInvalido('tarifa_consulta') }"
            />
            <span class="error-message" *ngIf="esCampoInvalido('tarifa_consulta')">
              {{ obtenerErrorCampo('tarifa_consulta') }}
            </span>
          </div>
        </div>
      </form>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="cerrarModal()" [disabled]="cargando">
        Cancelar
      </button>
      <button class="btn btn-primary" (click)="guardarPerfil()" [disabled]="cargando || formulario.invalid">
        <span *ngIf="!cargando">üíæ Guardar Cambios</span>
        <span *ngIf="cargando">‚è≥ Guardando...</span>
      </button>
    </div>
  </div>
</div>
